"use strict";var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function imageSclaer(e){var t=e.imageUrl,r=e.scaleTo,c=void 0===r?100:r,i=e.quality,s=void 0===i?1:i,o=e.mimeType,m=void 0===o?"jpeg":o;return new _promise2.default(function(u,e){if(["jpeg","png","webp"].includes(m)){var l=new Image;l.src=isLocalImage(t)?t:"https://images.weserv.nl/?url="+t,l.setAttribute("crossOrigin","Anonymous"),l.complete?r():l.onload=r,l.onerror=function(){e(new Error("load image error"))}}else e(new Error("mimeType wrong ! "));function r(){var e=document.createElement("canvas"),r=e.getContext("2d"),t=l.width,i=l.height,o=c/t,n=Math.round(t*o),a=Math.round(i*o);e.width=n,e.height=a,r.drawImage(l,0,0,n,a),e.toBlob(function(e){var r=window.URL.createObjectURL(e);u({blob:e,url:r})},"image/"+m,s)}})}function isLocalImage(e){if(e.includes("http")){if(e.includes("localhost")||e.includes("192.168.1.10"))return!0;var r=/http(s)?:\/\/(.*?)\//;return window.location.href.match(r)[0]===e.match(r)[0]}return!0}module.exports=imageSclaer;